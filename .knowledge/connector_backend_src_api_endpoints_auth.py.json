{"is_source_file": true, "format": "Python", "description": "This file defines API endpoints related to user authentication and management using FastAPI. It includes routes for login, registration, retrieving current user info, API key management, and token refresh, utilizing Pydantic schemas, dependency injection, and external security and database modules.", "external_files": ["src.core.security", "src.core.database", "src.core.exceptions", "src.models.schemas", "loguru"], "external_methods": ["token_manager.create_access_token", "password_manager.verify_password", "password_manager.hash_password", "api_key_manager.generate_api_key", "get_database", "get_current_user"], "published": ["router"], "classes": [{"name": "LoginRequest", "description": "Schema for login requests, containing username/email and password."}, {"name": "LoginResponse", "description": "Schema for login response, containing JWT token details and user info."}, {"name": "RegisterRequest", "description": "Schema for user registration input data."}, {"name": "UserResponse", "description": "Schema representing user data returned in responses."}, {"name": "APIKeyResponse", "description": "Schema for API key response details."}], "methods": [{"name": "login( login_request: LoginRequest, db = Depends(get_database) )", "description": "Authenticates user credentials and returns a JWT token along with user info.", "scope": "", "scopeKind": ""}, {"name": "register( register_request: RegisterRequest, db = Depends(get_database) )", "description": "Registers a new user and returns user information.", "scope": "", "scopeKind": ""}, {"name": "get_current_user_info( current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )", "description": "Retrieves information about the currently authenticated user.", "scope": "", "scopeKind": ""}, {"name": "generate_api_key( current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )", "description": "Generates and stores a new API key for the authenticated user.", "scope": "", "scopeKind": ""}, {"name": "revoke_api_key( key_id: str, current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )", "description": "Revokes an API key by setting it as inactive.", "scope": "", "scopeKind": ""}, {"name": "refresh_token( current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )", "description": "Refreshes the JWT token for the current user, issuing a new access token.", "scope": "", "scopeKind": ""}], "calls": ["token_manager.create_access_token", "password_manager.verify_password", "password_manager.hash_password", "api_key_manager.generate_api_key", "get_database", "get_current_user", "db.users.find_one", "db.users.update_one", "db.users.insert_one", "db.api_keys.insert_one", "db.api_keys.update_one"], "search-terms": ["FastAPI auth endpoints", "JWT token management", "User registration schema", "API key generation", "User login", "token refresh", "MongoDB user operations", "API key revocation"], "state": 2, "file_id": 17, "knowledge_revision": 54, "git_revision": "", "revision_history": [{"39": ""}, {"42": ""}, {"43": ""}, {"54": ""}], "ctags": [{"_type": "tag", "name": "APIKeyResponse", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^class APIKeyResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LoginRequest", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^class LoginRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LoginResponse", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^class LoginResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "RegisterRequest", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^class RegisterRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserResponse", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^class UserResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "access_token", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    access_token: str = Field(..., description=\"JWT access token\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "api_key", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    api_key: str = Field(..., description=\"Generated API key\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "APIKeyResponse", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    created_at: str = Field(..., description=\"Creation timestamp\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "APIKeyResponse", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    created_at: str = Field(..., description=\"Creation timestamp\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    email: str = Field(..., description=\"Email address\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "RegisterRequest", "scopeKind": "class"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    email: str = Field(..., description=\"Email address\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "expires_in", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    expires_in: int = Field(..., description=\"Token expiration time in seconds\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "full_name", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    full_name: Optional[str] = Field(None, description=\"Full name\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RegisterRequest", "scopeKind": "class"}, {"_type": "tag", "name": "full_name", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    full_name: Optional[str] = Field(None, description=\"Full name\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "generate_api_key", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^async def generate_api_key($/", "language": "Python", "kind": "function", "signature": "( current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )"}, {"_type": "tag", "name": "get_current_user_info", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^async def get_current_user_info($/", "language": "Python", "kind": "function", "signature": "( current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    id: str = Field(..., description=\"User identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "is_active", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    is_active: bool = Field(..., description=\"User active status\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "key_id", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    key_id: str = Field(..., description=\"API key identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "APIKeyResponse", "scopeKind": "class"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^async def login($/", "language": "Python", "kind": "function", "signature": "( login_request: LoginRequest, db = Depends(get_database) )"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    password: str = Field(..., description=\"Password\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginRequest", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    password: str = Field(..., min_length=8, description=\"Password\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "RegisterRequest", "scopeKind": "class"}, {"_type": "tag", "name": "refresh_token", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^async def refresh_token($/", "language": "Python", "kind": "function", "signature": "( current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^async def register($/", "language": "Python", "kind": "function", "signature": "( register_request: RegisterRequest, db = Depends(get_database) )"}, {"_type": "tag", "name": "revoke_api_key", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^async def revoke_api_key($/", "language": "Python", "kind": "function", "signature": "( key_id: str, current_user: Dict[str, Any] = Depends(get_current_user), db = Depends(get_database) )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "security", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^security = HTTPBearer()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "tenant_id", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    tenant_id: Optional[str] = Field(None, description=\"Tenant identifier\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RegisterRequest", "scopeKind": "class"}, {"_type": "tag", "name": "tenant_id", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    tenant_id: str = Field(..., description=\"Tenant identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "tenant_id", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    tenant_id: str = Field(..., description=\"Tenant identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "token_type", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    token_type: str = Field(default=\"bearer\", description=\"Token type\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "user_id", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    user_id: str = Field(..., description=\"User identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    username: str = Field(..., description=\"Username or email\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginRequest", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    username: str = Field(..., description=\"Username\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserResponse", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/api/endpoints/auth.py", "pattern": "/^    username: str = Field(..., min_length=3, max_length=50, description=\"Username\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "RegisterRequest", "scopeKind": "class"}], "hash": "e25de8b9f594870d566554962b8b224f", "format-version": 4, "code-base-name": "connector_backend", "filename": "connector_backend/src/api/endpoints/auth.py", "fields": [{"name": "str access_token", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str api_key", "scope": "APIKeyResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str created_at", "scope": "APIKeyResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str email", "scope": "RegisterRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "int expires_in", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] full_name", "scope": "RegisterRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str id", "scope": "UserResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_active", "scope": "UserResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str key_id", "scope": "APIKeyResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str password", "scope": "LoginRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "security = HTTPBearer()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] tenant_id", "scope": "RegisterRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str tenant_id", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str token_type", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str user_id", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str username", "scope": "LoginRequest", "scopeKind": "class", "description": "unavailable"}]}