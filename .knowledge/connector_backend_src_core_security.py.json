{"is_source_file": true, "format": "Python", "description": "This file provides security utilities for web applications, including token management, encryption, password hashing, and security headers middleware, tailored for a FastAPI project.", "external_files": ["src.core.config.settings"], "external_methods": ["settings.ACCESS_TOKEN_EXPIRE_MINUTES", "settings.SECRET_KEY", "settings.ENCRYPTION_KEY"], "published": ["get_current_user", "create_state_token", "verify_state_token"], "classes": [{"name": "SecurityHeaders", "description": "Middleware to add security headers to HTTP responses in FastAPI applications."}, {"name": "TokenManager", "description": "Utility class for creating and verifying JWT tokens."}, {"name": "EncryptionManager", "description": "Handles encryption and decryption of sensitive data using Fernet symmetric encryption."}, {"name": "PasswordManager", "description": "Provides static methods for hashing and verifying passwords with bcrypt."}, {"name": "APIKeyManager", "description": "Utility class for generating API keys and webhook secrets."}], "methods": [{"name": "str create_access_token(data: Dict[str, Any], expires_delta: Optional[timedelta] = None)", "description": "Creates a JWT token with an expiry based on the provided timedelta or default setting.", "scope": "TokenManager", "scopeKind": "class"}, {"name": "Dict[str,Any] verify_token(token: str)", "description": "Verifies and decodes a JWT token, raising HTTPException if invalid or expired.", "scope": "TokenManager", "scopeKind": "class"}, {"name": "str encrypt(self, data: str)", "description": "Encrypts plain text data into a base64-encoded string.", "scope": "EncryptionManager", "scopeKind": "class"}, {"name": "str decrypt(self, encrypted_data: str)", "description": "Decrypts a base64-encoded string back into plain text, with error handling.", "scope": "EncryptionManager", "scopeKind": "class"}, {"name": "str hash_password(password: str)", "description": "Hashes a plain text password using bcrypt.", "scope": "PasswordManager", "scopeKind": "class"}, {"name": "bool verify_password(password: str, hashed: str)", "description": "Checks a plain text password against its bcrypt hash.", "scope": "PasswordManager", "scopeKind": "class"}, {"name": "str generate_api_key()", "description": "Generates a secure random API key.", "scope": "APIKeyManager", "scopeKind": "class"}, {"name": "str generate_webhook_secret()", "description": "Generates a secure webhook secret token.", "scope": "APIKeyManager", "scopeKind": "class"}, {"name": "Dict[str,Any] get_current_user(credentials: HTTPAuthorizationCredentials = security)", "description": "FastAPI dependency to retrieve the current user from JWT token.", "scope": "", "scopeKind": ""}, {"name": "str create_state_token(tenant_id: str, connector_id: str)", "description": "Creates a short-lived OAuth state token encoding tenant and connector IDs.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] verify_state_token(state_token: str)", "description": "Decodes and verifies the OAuth state token, ensuring purpose correctness.", "scope": "", "scopeKind": ""}, {"name": "__call__(self, scope, receive, send)", "scope": "SecurityHeaders", "scopeKind": "class", "description": "unavailable"}, {"name": "__init__(self)", "scope": "EncryptionManager", "scopeKind": "class", "description": "unavailable"}, {"name": "__init__(self, app)", "scope": "SecurityHeaders", "scopeKind": "class", "description": "unavailable"}, {"name": "Fernet _create_fernet(self)", "scope": "EncryptionManager", "scopeKind": "class", "description": "unavailable"}, {"name": "send_wrapper(message)", "scope": "SecurityHeaders.__call__", "scopeKind": "member", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "bcrypt.gensalt", "bcrypt.hashpw", "bcrypt.checkpw", "secrets.token_urlsafe", "base64.urlsafe_b64encode", "base64.urlsafe_b64decode", "logger.error"], "search-terms": ["JWT token management", "FastAPI security headers", "cryptography Fernet encryption", "bcrypt password hashing", "OAuth state token", "API key generation"], "state": 2, "file_id": 8, "knowledge_revision": 22, "git_revision": "", "revision_history": [{"17": ""}, {"22": ""}], "ctags": [{"_type": "tag", "name": "APIKeyManager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^class APIKeyManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "EncryptionManager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^class EncryptionManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "PasswordManager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^class PasswordManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SecurityHeaders", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^class SecurityHeaders:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TokenManager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^class TokenManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__call__", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    async def __call__(self, scope, receive, send):$/", "language": "Python", "kind": "member", "signature": "(self, scope, receive, send)", "scope": "SecurityHeaders", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def __init__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "EncryptionManager", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def __init__(self, app):$/", "language": "Python", "kind": "member", "signature": "(self, app)", "scope": "SecurityHeaders", "scopeKind": "class"}, {"_type": "tag", "name": "_create_fernet", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def _create_fernet(self) -> Fernet:$/", "language": "Python", "typeref": "typename:Fernet", "kind": "member", "signature": "(self)", "scope": "EncryptionManager", "scopeKind": "class"}, {"_type": "tag", "name": "api_key_manager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^api_key_manager = APIKeyManager()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def create_access_token(data: Dict[str, Any], expires_delta: Optional[timedelta] = None) -> /", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(data: Dict[str, Any], expires_delta: Optional[timedelta] = None)", "scope": "TokenManager", "scopeKind": "class"}, {"_type": "tag", "name": "create_state_token", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^def create_state_token(tenant_id: str, connector_id: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(tenant_id: str, connector_id: str)"}, {"_type": "tag", "name": "decrypt", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def decrypt(self, encrypted_data: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, encrypted_data: str)", "scope": "EncryptionManager", "scopeKind": "class"}, {"_type": "tag", "name": "encrypt", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def encrypt(self, data: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, data: str)", "scope": "EncryptionManager", "scopeKind": "class"}, {"_type": "tag", "name": "encryption_manager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^encryption_manager = EncryptionManager()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "generate_api_key", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def generate_api_key() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "()", "scope": "APIKeyManager", "scopeKind": "class"}, {"_type": "tag", "name": "generate_webhook_secret", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def generate_webhook_secret() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "()", "scope": "APIKeyManager", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^async def get_current_user(credentials: HTTPAuthorizationCredentials = security) -> Dict[str, An/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(credentials: HTTPAuthorizationCredentials = security)"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(password: str)", "scope": "PasswordManager", "scopeKind": "class"}, {"_type": "tag", "name": "password_manager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^password_manager = PasswordManager()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "security", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^security = HTTPBearer()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "send_wrapper", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^            async def send_wrapper(message):$/", "file": true, "language": "Python", "kind": "function", "signature": "(message)", "scope": "SecurityHeaders.__call__", "scopeKind": "member"}, {"_type": "tag", "name": "token_manager", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^token_manager = TokenManager()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def verify_password(password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(password: str, hashed: str)", "scope": "PasswordManager", "scopeKind": "class"}, {"_type": "tag", "name": "verify_state_token", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^def verify_state_token(state_token: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(state_token: str)"}, {"_type": "tag", "name": "verify_token", "path": "/home/kavia/workspace/code-generation/unified-workflow-connector-145367-145377/connector_backend/src/core/security.py", "pattern": "/^    def verify_token(token: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(token: str)", "scope": "TokenManager", "scopeKind": "class"}], "hash": "b519beb277f437c38b395e9ddcb52a6c", "format-version": 4, "code-base-name": "connector_backend", "filename": "connector_backend/src/core/security.py", "fields": [{"name": "api_key_manager = APIKeyManager()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "encryption_manager = EncryptionManager()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "password_manager = PasswordManager()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "security = HTTPBearer()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "token_manager = TokenManager()", "scope": "", "scopeKind": "", "description": "unavailable"}]}